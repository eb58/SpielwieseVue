<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Vue Test</title>
  <link rel="stylesheet" href="lib/jQueryUI-1.11.4/jquery-ui.css">
  <style>
    * {
      font-family:Arial;
      color: black;
      font-size: 12px;
    }
    body { width: 800px; }
    #grid #data table{ width: 100%; }
  </style>
  <script src="lib/underscore-1.8.3/underscore.js"></script>
  <script src="lib/jquery-1.11.3/jquery.js"></script>
  <script src="lib/jQueryUI-1.11.4/jquery-ui.js"></script>
  <script src="lib/vue/vue.js"></script>
  <script>
    var vue;
    $(document).ready(function () {
      Vue.directive('datepicker2', {
        bind: function () {
          var vm = this.vm;
          var key = this.expression;
          $(this.el).datepicker({
            dateFormat: 'dd.mm.yy',
            onClose: function (date) {
              if (date.match(/^(0?[1-9]|[12][0-9]|3[01])[\/\-\.](0?[1-9]|1[012])[\/\-\.]\d{4}$/))
                vm.$set(key, date);
              else {
                vm.$set(key, "");
                console.log('invalid date');
              }
            }
          });
        },
        update: function (val) {
          $(this.el).datepicker('setDate', val);
          console.log('update Datepicker');
        }
      });
      Vue.directive('selectmenu', {
        bind: function () {
          var vm = this.vm;
          var key = this.expression;
          $(this.el).selectmenu({change: function (event, ui) {
              vm.$set(key, ui.item.value);
            }});
        },
        update: function (val) {
          $(this.el).selectmenu().val(val).selectmenu('refresh');
          console.log('update Selectmenu');
        }
      });

      vue = new Vue({
        el: '#app',
        data: {
          message: 'Hello Vue.js!',
          b: true,
          picked: 'one',
          selected: 'two',
          dt: '04/29/2015',
          sm2: 1,
          options: [
            {text: 'AAA', value: 1},
            {text: 'BBB', value: 2},
            {text: 'CCC', value: 3}
          ],
        },
        computed: {
          rev_message: function () {
            return this.message.split('').reverse().join('');
          }
        },
        methods: {
          CheckDate: function () {
            console.log(this.dt);
          }
        }
      });
    });
  </script>
</head>

<body>

  <div id="app">
    <input v-model="message">
    <p>{{ message }}</p>
    <p>{{ rev_message }}</p>
    <p><input type="checkbox" v-model="b">{{b ? "yes" : "no"}}</p>  
    <p>
      <label for="one">One<input type="radio" id='one' name="picked" value="one" v-model="picked"></label>
      <label for="two">Two<input type="radio" id='two' name="picked" value="two" v-model="picked"></label>
      {{picked}}
    </p>
    <input type="text" v-datepicker2="dt" />
    <button v-on="click:CheckDate">CheckDate</button>

    <br/><select id='xxx' v-selectmenu='sm2'>
      <option v-for="option in options" v-bind:value="option.value">{{ option.text }}</option>
    </select>

    <p><pre>data: {{$data | json 2}}</pre></p>
</div>

</body>
</html>
